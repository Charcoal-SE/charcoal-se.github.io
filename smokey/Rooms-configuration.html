<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>
    Rooms configuration | Charcoal
    
  </title>
  <link type="text/css" rel="stylesheet" href="/assets/application-246c1429bdd26544d97cac0305ef38e82170d25f6012981a46fe9d1901d56911.css">
  <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=default,fetch"></script>
  <script>window.algoliaLogoHTML = '<img src="/assets/search-by-algolia-f11921c9ad37d8af1d526ce35d9994eb44ad34b8229c1714edbf5cef12f804dc.svg" height="16" alt="Search by Algolia" width="168">'</script>
  <script type="text/javascript" src="/assets/application-b015c31784daac3c018b559e16583f1f9b87495cffd99b5eddc4ec0d5d73f144.js"></script>
  <script type="text/javascript" src="/assets/vendor-ecc837bbd5d3e5dbfb38524f3faaf1406e7e5490330a1bd2b4728be17a5fffa7.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon"
            type="image/png"
            href="/assets/charcoal-fd5b673dc87bbcf444be78adbf43a1198e981d2133de0a3eab4810ca047efbb7.png" />
</head>
<body>
  <div class="body-container">
    
    <div class="header">
      <div class="header-icon text-center">
        <a href="/">
          <img src="/assets/charcoal-fd5b673dc87bbcf444be78adbf43a1198e981d2133de0a3eab4810ca047efbb7.png" height="64" width title="Charcoal: spam-crusaders of the Internet" alt="charcoal.png">
          <span class="title">
            <span>Charcoal</span>
            <small>spam-crusaders of the Internet</small>
          </span>
        </a>
        <label class="nav-toggle-icon fa fa-bars fa-lg" for="nav-toggle"></label>
      </div>
      <input type="checkbox" id="nav-toggle">
      <nav class="text-center top-nav">
        <div class="search-nav">
          <i class="fa fa-search search-icon inline-icon fa-fw"></i>
          <input type="text" placeholder="Search…" id="search-input">
          <a href="#" id="search-close" class="inline-icon close-icon"><i class="fa fa-times fa-fw"></i></a>
        </div>
        <ul class="main-nav">
          <li><a href="/"><i class="fa fa-home" title="Home"></i><span class="mobile-only"> Home</span></a></li>
          <li><a href="https://chat.stackexchange.com/rooms/11540/charcoal-hq"><i class="fa mobile-only fa-comments-o"></i> chat</a></li>
          <li>
            <label class="link" for="projects-toggle">
              more projects <i class="fa fa-chevron-down"></i>
            </label>
            <input type="checkbox" id="projects-toggle">
            <nav class="nav-dropdown">
              <a href="https://metasmoke.erwaysoftware.com/" >metasmoke</a>
            
              <a href="https://charcoal-se.org/ms-urls" >metasmoke URL converter</a>
            
              <a href="https://flovis.charcoal-se.org/" >Farmhouse (Flovis)</a>
            
              <a href="https://charcoal-se.org/blaze" data-turbolinks="false">Blaze</a>
            </nav>
          </li>
          <li><a href="/scripts"><i class="fa mobile-only fa-file-code-o"></i> userscripts</a></li>
          <li><a href="/smokey/"><i class="fa mobile-only fa-file-text-o"></i> wiki</a></li>
          <li>
            <a href="/ms/API-Documentation-(V2)"><i class="fa mobile-only fa-book"></i> api</a>
            (<a href="/ms/API-Documentation-(V1)">v1</a>)
          </li>
          <li><a href="https://github.com/Charcoal-SE" title="GitHub organization"><i class="fa fa-github"></i><span class="mobile-only"> GitHub</span></a></li>
          <li><a href="#" class="search-link"><i class="fa fa-search" title="Search"></i><span class="mobile-only"> Search</span></a></li>
        </ul>
      </nav>
    </div>
    <div class="body">
      


<h1 id="rooms-configuration">Rooms configuration</h1>

<p>The Wiki page explains the following:</p>
<ul>
  <li>File structure for the rooms.yml file</li>
  <li>Glossary of terms used in rooms.yml</li>
  <li>How to configure SmokeDetector for development</li>
</ul>

<h3 id="file-structure">File structure</h3>

<p>The file is a yaml/yml markdown file which has 3 sections, one for each chat domain:</p>
<ul>
  <li>stackexchange.com</li>
  <li>meta.stackexchange.com</li>
  <li>stackoverflow.com</li>
</ul>

<p>Each section contains the following structure:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;chat host&gt;:
  &lt;room id&gt;:
    commands: true/false,
    watcher: true/false,
    msg_types:
      - &lt;role string...&gt;
      - ...

    privileges: 
      - &lt;user id...&gt;
      - ...
</code></pre></div></div>
<h3 id="glossary">Glossary</h3>

<ul>
  <li><code class="highlighter-rouge">&lt;chat host&gt;</code> - The domain in which the chat host is a sub-domain. Stack Exchange has 3 chat domains: chat.stackexchange.com, chat.meta.stackexchange.com, and chat.stackoverflow.com. The correct entries for <code class="highlighter-rouge">&lt;chat host&gt;</code> corresponding to these domains are <code class="highlighter-rouge">stackexchange.com</code>, <code class="highlighter-rouge">meta.stackexchange.com</code>, and <code class="highlighter-rouge">stackoverflow.com</code>.  Each chat server has independent rate limiting for the chat messages a single user can post. If you’re making a test room into which the SmokeDetector user is going to be posting lots of messages, then please create the room on either <code class="highlighter-rouge">meta.stackexchange.com</code> or <code class="highlighter-rouge">stackoverflow.com</code>. SmokeDetector currently posts most of it’s messages to the <code class="highlighter-rouge">stackexchange.com</code> chat server, which means it’s the one that gets rate-limited the most.</li>
  <li><code class="highlighter-rouge">&lt;room id&gt;</code> - room id for the rooms with which SmokeDetector interacts. For example: 12345.</li>
  <li><code class="highlighter-rouge">commands</code> - true/false boolean flag which determines if SmokeDetector listens for commands in the room</li>
  <li><code class="highlighter-rouge">watcher</code> - true/false boolean flag which determines if during the 2 minute chat edit/delete window, the report receives FP feedback from feedback in that chat room, or the SE post is deleted, then SmokeDetector will delete the report.</li>
  <li><code class="highlighter-rouge">msg_types</code> - kinds of messages the room will receive, as described in the following role_string types:
    <ul>
      <li>Define which sites will have spam reports posted to the room:
        <ul>
          <li><code class="highlighter-rouge">all</code>: Reports for all sites will be posted to the room.</li>
          <li><code class="highlighter-rouge">site-&lt;site&gt;</code>: The room will receive reports about SE posts on the indicated site (e.g <code class="highlighter-rouge">site-askubuntu.com</code> or <code class="highlighter-rouge">site-codegolf.stackexchange.com</code>). There can be multiple <code class="highlighter-rouge">site-&lt;site&gt;</code> lines to include more than one site.</li>
          <li><code class="highlighter-rouge">site-no-&lt;site&gt;</code>: exclude a site’s reports from being posted in the room (e.g. <code class="highlighter-rouge">site-no-stackoverflow.com</code>); normally used in combination with <code class="highlighter-rouge">all</code>. There can be multiple <code class="highlighter-rouge">site-no-&lt;site&gt;</code> lines to exclude more than one site.</li>
        </ul>
      </li>
      <li><code class="highlighter-rouge">debug</code>: This is what Charcoal HQ or your main room would have set. Rooms with this set will receive startup messages and other debugging information (basically anything that would have previously been done with GlobalVars.charcoal_hq.send_message).</li>
      <li><code class="highlighter-rouge">delay</code>: introduces a 5 minute delay for reports; reports won’t be posted if the post has been marked as false positive or deleted within the 5 minute window.</li>
      <li><code class="highlighter-rouge">dump</code>: used for Socket Science. Do not add this, unless you are a developer working on Socket Science. Rooms with the <code class="highlighter-rouge">dump</code> option <em>must</em> exist and not be deleted, or SmokeDetector will fail when becoming the “active” instance. If a room defined as <code class="highlighter-rouge">dump</code> becomes deleted, then you will probably want to ping the owners of any SmokeDetector instances which have gone off-line as a result. The quickest way to get those instances back will be to have the owners manually pull a new version of rooms.yml from Github with the <code class="highlighter-rouge">dump</code> removed. SmokeDetector instances that are in standby can be instructed to pull a newer version from GitHub through the status page on metasmoke.</li>
      <li><code class="highlighter-rouge">experimental</code>: Without this option, reports detected for <em>only</em> experimental reasons will not be posted in the chatroom. However, this option is all-or-nothing. If <code class="highlighter-rouge">experimental</code> is included, then <em>all</em> reports for <em>all sites</em> which are detected for only experimental reasons will be posted in the room. In other words, it ignores the <code class="highlighter-rouge">site--&lt;site&gt;</code> and <code class="highlighter-rouge">site-no-&lt;site&gt;</code> settings. From SmokeDetector’s point of view, the experimental reasons are defined in <code class="highlighter-rouge">experimental_reasons</code> in the <a href="https://github.com/Charcoal-SE/SmokeDetector/blob/master/globalvars.py#L69">globalvars.py</a> file. Experimental reasons are also separately defined on metasmoke (ping a metasmoke developer, if those should change).</li>
      <li><code class="highlighter-rouge">metasmoke</code>: Messages sent from metasmoke are forwarded to this room. This includes things like notification of the first feedback received for a report, CI success/failure which metasmoke is monitoring, etc. This is intended for additional information in Charcoal HQ.</li>
      <li><code class="highlighter-rouge">metatavern</code>: A special role created for the Tavern on Meta, currently it just receives messages about blocks (for Town Halls).</li>
      <li><code class="highlighter-rouge">no-&lt;reason&gt;</code>: This room won’t receive reports with the specified reason (e.g <code class="highlighter-rouge">no-all-caps body</code>)</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">privileges</code> - who can run privileged commands in this room. There are two mutually exclusive formats to what this section can contain.<br />
The first is a list of SE Network user IDs, one per line. Each user ID must be defined in <a href="https://github.com/Charcoal-SE/SmokeDetector/blob/master/users.yml">users.yml</a>.<br />
The other format is <code class="highlighter-rouge">inherit</code>/<code class="highlighter-rouge">additional</code>:
    <ul>
      <li><code class="highlighter-rouge">inherit</code>: indicates the list of permissions should be inherited from another room.
        <ul>
          <li><code class="highlighter-rouge">site</code>: a “chat host” (see above) which contains the room from which to inherit.</li>
          <li><code class="highlighter-rouge">room</code>: the number of the room from which the list of permitted user IDs is to be inherited.</li>
        </ul>
      </li>
      <li><code class="highlighter-rouge">additional</code>: a list of SE Network user IDs, one per line, which are privileged in this room in addition to those inherited from the <code class="highlighter-rouge">site</code>/<code class="highlighter-rouge">room</code> defined in <code class="highlighter-rouge">inherit</code>. If <code class="highlighter-rouge">inherit</code> is used, <code class="highlighter-rouge">additional</code> is available. When available, it is optional.</li>
    </ul>
  </li>
</ul>

<h3 id="configuring-rooms-for-development">Configuring rooms for development</h3>

<p>During development, you probably want to avoid posting a bunch of reports and debug messages to our main rooms. In this case, you can set up a custom rooms.yml file to configure where Smokey will post messages.</p>

<p>Simply create a file named <code class="highlighter-rouge">rooms_custom.yml</code>, and fill it in using the format described above. If you need a spare room to test in, we have one available for your use:</p>

<ul>
  <li><a href="https://chat.stackexchange.com/rooms/65945/charcoal-test">Charcoal Test</a></li>
</ul>

<p>If you don’t want Smokey to post any chat messages, you can simply leave the file blank.</p>


<div class="sidebar">



<p><strong><a href="//github.com/Charcoal-SE/SmokeDetector/wiki/Rooms-configuration/_edit"><i class="fa fa-pencil"></i> Edit on GitHub</a></strong></p>

<div class="sidebar-content sidebar-content-smokey">

  <p><strong><a href="Home">Home</a></strong></p>

  <p><strong><a href="http://chat.stackexchange.com/rooms/11540/charcoal-hq">Charcoal HQ</a></strong></p>

  <p><strong><a href="http://charcoal-se.org/">Charcoal Website</a></strong></p>

  <p><strong><a href="https://metasmoke.erwaysoftware.com">metasmoke</a></strong></p>

  <p><strong><a href="https://github.com/Charcoal-SE/userscripts">Userscripts</a></strong></p>

</div>


</div>


<div class="footer footer-insert text-center">
<p>Smokey is made with &lt;3 by the <a href="https://charcoal-se.org/people.html">Charcoal Team</a> and the other awesome <a href="https://github.com/Charcoal-SE/SmokeDetector/graphs/contributors">contributors</a> from <a href="https://chat.stackexchange.com/rooms/11540/charcoal-hq">Charcoal HQ</a>.</p>
</div>

    </div>
    <div class="footer text-center">
      <p>Charcoal is not affiliated with or sponsored by Stack Exchange, Inc.<br />
        <a href="/security">Security</a> • <a href="/pings/">Contact</a>
      </p>
      <p>
        <a href="https://github.com/Charcoal-SE/charcoal-se.github.io">Website Source</a>
        • By
          
            <a href="https://github.com/j-f1" class="avatar-link">
              <img class="avatar avatar-small" alt="j-f1" width="16" height="16" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/j-f1?v=3&s=16" srcset="https://avatars2.githubusercontent.com/j-f1?v=3&s=16 1x, https://avatars2.githubusercontent.com/j-f1?v=3&s=32 2x, https://avatars2.githubusercontent.com/j-f1?v=3&s=48 3x, https://avatars2.githubusercontent.com/j-f1?v=3&s=64 4x" />j-f1</a>,
          
            <a href="https://github.com/ArtOfCode-" class="avatar-link">
              <img class="avatar avatar-small" alt="ArtOfCode-" width="16" height="16" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/ArtOfCode-?v=3&s=16" srcset="https://avatars2.githubusercontent.com/ArtOfCode-?v=3&s=16 1x, https://avatars2.githubusercontent.com/ArtOfCode-?v=3&s=32 2x, https://avatars2.githubusercontent.com/ArtOfCode-?v=3&s=48 3x, https://avatars2.githubusercontent.com/ArtOfCode-?v=3&s=64 4x" />ArtOfCode-</a>,
          
            <a href="https://github.com/iBug" class="avatar-link">
              <img class="avatar avatar-small" alt="iBug" width="16" height="16" data-proofer-ignore="true" src="https://avatars0.githubusercontent.com/iBug?v=3&s=16" srcset="https://avatars0.githubusercontent.com/iBug?v=3&s=16 1x, https://avatars0.githubusercontent.com/iBug?v=3&s=32 2x, https://avatars0.githubusercontent.com/iBug?v=3&s=48 3x, https://avatars0.githubusercontent.com/iBug?v=3&s=64 4x" />iBug</a>,
          
            <a href="https://github.com/angussidney" class="avatar-link">
              <img class="avatar avatar-small" alt="angussidney" width="16" height="16" data-proofer-ignore="true" src="https://avatars1.githubusercontent.com/angussidney?v=3&s=16" srcset="https://avatars1.githubusercontent.com/angussidney?v=3&s=16 1x, https://avatars1.githubusercontent.com/angussidney?v=3&s=32 2x, https://avatars1.githubusercontent.com/angussidney?v=3&s=48 3x, https://avatars1.githubusercontent.com/angussidney?v=3&s=64 4x" />angussidney</a>,
          
          and
          <a href="https://github.com/Charcoal-SE/charcoal-se.github.io/graphs/contributors">
            14 more</a>
        
          • <a href="/code">More gory details</a>
        
      </p>
      
    </div>
  </div>
  <script>
    window.searchConfig = {
      appId: 'TMPUB31BTZ',
      key: 'c63c2f79258f929439376cfb88862440',
      index: 'main-search',
      baseUrl: '',
    }
    window.redirects = { "/channel": "https://stackoverflow.com/c/charcoal", "/m": "https://metasmoke.erwaysoftware.com", "/store": "https://www.zazzle.co.uk/charcoal_se/products", "/smokey/Home": "https://charcoal-se.org//smokey/", "/smokey/Home": "https://charcoal-se.org//smokey/", "/ms/Home": "https://charcoal-se.org//ms/", "/ms/Home": "https://charcoal-se.org//ms/", "/announcements": "https://charcoal-se.org//announcements/", "/userscripts/": "https://charcoal-se.org//scripts.html", "/userscripts": "https://charcoal-se.org//scripts.html",  }
  </script>
  <!-- Hotjar Tracking Code for charcoal-se.org -->
  <script>
    (function(h,o,t,j,a,r){
      h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
      h._hjSettings={hjid:771814,hjsv:6};
      a=o.getElementsByTagName('head')[0];
      r=o.createElement('script');r.async=1;
      r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
      a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
  </script>
</body>
</html>
