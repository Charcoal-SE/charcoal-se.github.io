<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>
    API Documentation (V2) | Charcoal
    
  </title>
  <link type="text/css" rel="stylesheet" href="/assets/application-0af23b9271f4af0499f4e1c18c5c797afb37c9dcbba3a992a3e5e26a48b5cbc6.css">
  <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=default,fetch"></script>
  <script>window.algoliaLogoHTML = '<img src="/assets/search-by-algolia-f11921c9ad37d8af1d526ce35d9994eb44ad34b8229c1714edbf5cef12f804dc.svg" height="16" alt="Search by Algolia" width="168">'</script>
  <script type="text/javascript" src="/assets/application-678e5bc73276f2c4a030350cf70f2a32f496473871f3004a00e5ab64924f2670.js"></script>
  <script type="text/javascript" src="/assets/vendor-ecc837bbd5d3e5dbfb38524f3faaf1406e7e5490330a1bd2b4728be17a5fffa7.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon"
            type="image/png"
            href="/assets/charcoal-fd5b673dc87bbcf444be78adbf43a1198e981d2133de0a3eab4810ca047efbb7.png" />
</head>
<body>
  <div class="body-container">
    
    <div class="header">
      <div class="header-icon text-center">
        <a href="/">
          <img src="/assets/charcoal-fd5b673dc87bbcf444be78adbf43a1198e981d2133de0a3eab4810ca047efbb7.png" height="64" width title="Charcoal: spam-crusaders of the Internet" alt="charcoal.png">
          <span class="title">
            <span>Charcoal</span>
            <small>spam-crusaders of the Internet</small>
          </span>
        </a>
        <label class="nav-toggle-icon fa fa-bars fa-lg" for="nav-toggle"></label>
      </div>
      <input type="checkbox" id="nav-toggle">
      <nav class="text-center top-nav">
        <div class="search-nav">
          <i class="fa fa-search search-icon inline-icon fa-fw"></i>
          <input type="text" placeholder="Search…" id="search-input">
          <a href="#" id="search-close" class="inline-icon close-icon"><i class="fa fa-times fa-fw"></i></a>
        </div>
        <ul class="main-nav">
          <li><a href="/"><i class="fa fa-home" title="Home"></i><span class="mobile-only"> Home</span></a></li>
          <li><a href="https://chat.stackexchange.com/rooms/11540/charcoal-hq"><i class="fa mobile-only fa-comments-o"></i> chat</a></li>
          <li>
            <label class="link" for="projects-toggle">
              more projects <i class="fa fa-chevron-down"></i>
            </label>
            <input type="checkbox" id="projects-toggle">
            <nav class="nav-dropdown">
              <a href="https://metasmoke.erwaysoftware.com/" >metasmoke</a>
            
              <a href="https://charcoal-se.org/ms-urls" >metasmoke URL converter</a>
            
              <a href="https://charcoal-se.org/blaze" data-turbolinks="false">Blaze</a>
            </nav>
          </li>
          <li><a href="/scripts"><i class="fa mobile-only fa-file-code-o"></i> userscripts</a></li>
          <li><a href="/smokey/"><i class="fa mobile-only fa-file-text-o"></i> wiki</a></li>
          <li>
            <a href="/ms/API-Documentation-(V2)"><i class="fa mobile-only fa-book"></i> api</a>
            (<a href="/ms/API-Documentation-(V1)">v1</a>)
          </li>
          <li><a href="https://github.com/Charcoal-SE" title="GitHub organization"><i class="fa fa-github"></i><span class="mobile-only"> GitHub</span></a></li>
          <li><a href="#" class="search-link"><i class="fa fa-search" title="Search"></i><span class="mobile-only"> Search</span></a></li>
        </ul>
      </nav>
    </div>
    <div class="body">
      


<h1 id="api-documentation-v2">API Documentation (V2)</h1>

<!--
                                 ############################################
                                 # DO NOT EDIT THIS DOCUMENTATION DIRECTLY! #
                                 ############################################

Well, okay, you can edit the text at the top, but leave that giant table alone unless you've regenerated it properly. TL;DR: the docs are held in the metasmoke repo, `app/api/docs`, and the table is generated from those docs by running `app/api/scripts/create_docs.rb`. Commit any changes you want to make to the repo before re-generating the table and pasting it here.

Scroll down for docs.
-->

<p>This page contains documentation for <strong>version 2.0</strong> of the metasmoke API. If that’s not what you’re expecting, you’re in the wrong place.</p>

<h3 id="authentication">Authentication</h3>
<p>Like 1.0, you need a key to access the API. Ping an admin to get one if you don’t already have one. If you’ve previously been given a key but no longer have it, you should be able to access it at <a href="https://metasmoke.erwaysoftware.com/admin/keys/mine">https://metasmoke.erwaysoftware.com/admin/keys/mine</a>.</p>

<p>For write authentication, the same flow applies as for v1. <strong>You don’t need to do this if you only want to read data!</strong></p>
<ul>
  <li>Send your user to <code class="language-plaintext highlighter-rouge">https://metasmoke.erwaysoftware.com/oauth/request?key=YOUR_KEY_HERE</code>.</li>
  <li>If the user authorizes your app, they will be given a code to provide you. Ask them to enter this code, then:</li>
  <li>Send a HTTP GET request to <code class="language-plaintext highlighter-rouge">https://metasmoke.erwaysoftware.com/oauth/token?key=YOUR_KEY_HERE&amp;code=THEIR_CODE_HERE</code>. The response is a JSON object containing one key, <code class="language-plaintext highlighter-rouge">token</code>, the value of which is your write token. Include this as the <code class="language-plaintext highlighter-rouge">token</code> parameter on any requests that require it.</li>
</ul>

<h3 id="filters">Filters</h3>
<p>Filters have been totally reworked in V2 of the API; they really were that terrible in v1. Again, visit <a href="https://metasmoke.erwaysoftware.com/api/filters">https://metasmoke.erwaysoftware.com/api/filters</a> to create a filter, and include it as the <code class="language-plaintext highlighter-rouge">filter</code> parameter on any requests you need it for.</p>

<p>Filters are <em>not quite</em> immutable. If the server configuration remains the same, then the same filter will always represent the same fields. However, if the server configuration changes - such as to add a new field to the API - then filters will also change. If you’re getting an SQL error on your requests, this is probably the cause - go recalculate your filters.</p>

<p>You can calculate filters programmatically if you wish: send a POST request to <code class="language-plaintext highlighter-rouge">https://metasmoke.erwaysoftware.com/api/filters</code> with the <code class="language-plaintext highlighter-rouge">fields</code> parameter set to an array of field names that you want to include (i.e. <code class="language-plaintext highlighter-rouge">['announcements.id', 'announcements.text', 'announcements.expiry']</code>), and you will get back a JSON object containing the filter.</p>

<blockquote>
  <p><em>You</em> may <em>also include the filter-generation logic directly in your application if you really want; it’s less complex than v1’s, so that’s not too much of a liability. Bear in mind, however, that if the metasmoke implementation changes you will need to push out an update to your implementation to match.</em></p>
</blockquote>

<h3 id="pagination">Pagination</h3>
<p>Responses from the API are paginated (that is, a long list of results will be split into pages and only the first page of results returned; further pages may be fetched by additional requests specifying a page number). The <code class="language-plaintext highlighter-rouge">has_more</code> field in the response indicates whether or not more pages are available beyond the current page.</p>

<p>The default page size is 10 items; you can control this using the <code class="language-plaintext highlighter-rouge">per_page</code> parameter. To fetch pages beyond 1, specify the requested page number in the <code class="language-plaintext highlighter-rouge">page</code> parameter.</p>

<h2 id="routes">Routes</h2>
<p>Routes marked with [W] are write routes; you must use a POST request and present a write token for these routes.
One must present a metasmoke key for all routes. For GET routes, the key need to be in the query string. For POST routes, the key can be either in the body or in the query string.</p>

<table>
<thead>
<tr><td><strong>Path</strong></td><td><strong>Description</strong></td></tr>
</thead>
<tbody>
<tr><td><strong>Announcements</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/announcements </code></td><td><details><summary> List all announcements.</summary><p>Available tables: <code>announcements</code><br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 25,
            &quot;text&quot;: &quot;Test API announcement&quot;,
            &quot;expiry&quot;: &quot;2017-12-13T19:00:00.000Z&quot;
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/announcements/active </code></td><td><details><summary> List active (non-expired) announcements.</summary><p>Available tables: <code>announcements</code><br />
Output format: identical to <code>/announcements</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/announcements/expired </code></td><td><details><summary> List expired announcements.</summary><p>Available tables: <code>announcements</code><br />
Output format: identical to <code>/announcements</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/announcements/create </code></td><td><details><summary> [W] Create an announcement.</summary><p>Available tables: N/A. All fields are returned. Filter is ignored.<br /><br />
Requires params: <code>text</code> and <code>expiry</code>. Requires core role.<br /><br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 27,
            &quot;text&quot;: &quot;test from API&quot;,
            &quot;expiry&quot;: &quot;2017-01-01T00:00:00.000Z&quot;,
            &quot;created_at&quot;: &quot;2017-12-17T23:11:55.000Z&quot;,
            &quot;updated_at&quot;: &quot;2017-12-17T23:11:55.000Z&quot;
        }
    ],
    &quot;has_more&quot;: false
}
</code></pre>
</details></td></tr>
<tr><td><strong>Apps</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/apps </code></td><td><details><summary> List all apps.</summary><p>Available tables: <code>api_keys</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 21,
            &quot;app_name&quot;: &quot;thesecretmaster&#39;s app&quot;,
            &quot;user_id&quot;: 298,
            &quot;github_link&quot;: &quot;&quot;
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><strong>Comments</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/comments </code></td><td><details><summary> List all comments.</summary><p>Available tables: <code>post_comments</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 2,
            &quot;user_id&quot;: 1373,
            &quot;text&quot;: &quot;Some more words.&quot;
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/comments/post/:id </code></td><td><details><summary> List all comments on a specified post.</summary><p>Available tables: <code>post_comments</code>.<br />
Output format: identical to <code>/comments</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/comments/post/:id/add </code></td><td><details><summary> Add a comment to a post.</summary><p>Requires parameters: <code>text</code>.<br />
Available tables: N/A. All fields on the created comment are returned.<br />
Output format: identical to <code>/comments</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/comments/post/:id </code></td><td><details><summary> [W] [Smokey] Add an automatic comment to a post.</summary><p><strong>This route is for use by SmokeDetector instances only.</strong><br />
Requires parameters: <code>text</code>, <code>chat_user_id</code>, and <code>chat_host</code>.<br />
Available tables: N/A. All fields on the created comment are returned.<br />
Output format: identical to <code>/comments</code>.</p>
</details></td></tr>
<tr><td><strong>Commit Statuses</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/commits </code></td><td><details><summary> List all commit statuses.</summary><p>Available tables: <code>commit_statuses</code>. Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 3689,
            &quot;commit_sha&quot;: &quot;cb94d4592f0a0085302ad2dbed1b4aaa5db85d09&quot;,
            &quot;status&quot;: &quot;success&quot;
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><strong>Debug</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/debug </code></td><td><details><summary> Return debugging information for the API.</summary><p>No database queries are performed by this route; no tables are available.<br />
Not really intended for API consumer use, more for API developers.<br />
Output format:</p>

<pre><code>{
    &quot;params&quot;: {
        &quot;key&quot;: &quot;abcdef012345&quot;,
        &quot;per_page&quot;: &quot;1&quot;
    },
    &quot;ts&quot;: &quot;2017-12-18T00:46:14.812+00:00&quot;,
    &quot;filters&quot;: {
        &quot;announcements&quot;: &quot;IJIHMOFFGGKIOKOGFJHMHHLOMIJFNGLLOHKMGIFKOMKLIILOGHLNNMJHJ&quot;,
        &quot;apps&quot;: &quot;MJMFOGKMLGMHGHFNGNJJOLOJGMKMIKMMKMHMFGJGIKIHHFLJKFLFLFN&quot;,
        &quot;commits&quot;: &quot;GFHIFKGGJLGIGLIHFJHMJHKMOINHOFGIONGGIMKOGKHMNFFNIH&quot;,
        &quot;deletions&quot;: &quot;MOOHKNMFMOGKIIMKIIIOHLJFGJHNOGMGMHMLIMJIINGFOJJ&quot;,
        &quot;tags&quot;: &quot;GHJNNJGMIGGGMMGJNOKOHLFFFHHIHLNIFNHJJIIJOFIHOL&quot;,
        &quot;feedbacks&quot;: &quot;HJKLKLLJLIHMKLINOKKJIJMOIOLKOMGJHGFMHGJIGKKH&quot;,
        &quot;posts&quot;: &quot;HKOMIKHOJJOHKLINJNOHMHMHKFGHJN&quot;,
        &quot;reasons&quot;: &quot;HOKGJMOFKGMOIKHNHKNKLFF&quot;,
        &quot;smokeys&quot;: &quot;ILMLMLLNNIHNHOJJ&quot;,
        &quot;domains&quot;: &quot;INJNHOFLOMHGL&quot;,
        &quot;users&quot;: &quot;JIKH&quot;
    }
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/debug/filter </code></td><td><details><summary> Decode a filter back to a list of fields.</summary><p>No database queries are performed by this route; no tables are available.<br />
Pass a filter as the <code>filter</code> parameter to receive a list of fields the filter contains.<br />
Output format:</p>

<pre><code>{
    &quot;fields&quot;: [
        &quot;posts.id&quot;,
        &quot;posts.title&quot;,
        &quot;posts.link&quot;,
        &quot;posts.site_id&quot;,
        &quot;posts.user_link&quot;,
        &quot;posts.username&quot;,
        &quot;posts.user_reputation&quot;
    ]
}
</code></pre>
</details></td></tr>
<tr><td><strong>Deletion logs</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/deletions </code></td><td><details><summary> List all deletion logs.</summary><p>Available tables: <code>deletion_logs</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 79044,
            &quot;post_id&quot;: 78091,
            &quot;is_deleted&quot;: true
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/deletions/post/:id </code></td><td><details><summary> List deletion logs on the post specified.</summary><p>Available tables: <code>deletion_logs</code>.<br />
Output format: identical to <code>/deletions</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/deletions/post/:id </code></td><td><details><summary> [W] Add a deletion log to a post.</summary><p><strong>Write route.</strong> Requires a POST request, trusted key, and valid write token.<br />
Available tables: N/A. All fields on the created deletion log are returned.<br />
Parameters: <code>is_deleted</code> (Boolean, required), <code>uncertainty</code> (Integer, seconds uncertainty, optional), <code>timestamp</code> (DateTime, deletion timestamp, optional)<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 106575,
            &quot;post_id&quot;: 100000,
            &quot;is_deleted&quot;: true,
            &quot;created_at&quot;: &quot;2021-01-01T00:00:00.000Z&quot;,
            &quot;updated_at&quot;: &quot;2018-02-15T21:12:02.000Z&quot;,
            &quot;api_key_id&quot;: 1,
            &quot;uncertainty&quot;: 0
        }
    ],
    &quot;has_more&quot;: false
}
</code></pre>
</details></td></tr>
<tr><td><strong>Tags</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/tags </code></td><td><details><summary> List all tags.</summary><p>Available tables: <code>domain_tags</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 16,
            &quot;name&quot;: &quot;blargle&quot;,
            &quot;description&quot;: null
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/tags/name/:name </code></td><td><details><summary> List tags specified by their name.</summary><p>Available tables: <code>domain_tags</code>.<br />
Output format: identical to <code>/tags</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/tags/:id/domains </code></td><td><details><summary> List the domains that a specific tag is used on.</summary><p>Available tables: <code>spam_domains</code>. Also available is <code>/api/v2.0/tags/name/:name/domains</code>, which returns domains on a tag specified by its name.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 12935,
            &quot;domain&quot;: &quot;infinitemlmsoftware.com&quot;,
            &quot;whois&quot;: null
        }
    ],
    &quot;has_more&quot;: false
}
</code></pre>
</details></td></tr>
<tr><td><strong>Feedbacks</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/feedbacks </code></td><td><details><summary> List all feedbacks</summary><p>Available tables: <code>feedbacks</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 141289,
            &quot;feedback_type&quot;: &quot;fp-&quot;,
            &quot;post_id&quot;: 78000,
            &quot;user_id&quot;: 7
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/feedbacks/post/:id </code></td><td><details><summary> List all feedbacks on the post specified.</summary><p>Available tables: <code>feedbacks</code>.<br />
Output format: identical to <code>/feedbacks</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/feedbacks/user/:id </code></td><td><details><summary> List all feedbacks by the user specified.</summary><p>Available tables: <code>feedbacks</code>.<br />
Output format: identical to <code>/feedbacks</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/feedbacks/app/:id </code></td><td><details><summary> List all feedbacks created by the app specified.</summary><p>Available tables: <code>feedbacks</code>.<br />
Output format: identical to <code>/feedbacks</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/feedbacks/post/:id/create </code></td><td><details><summary> [W] Create a feedback on the post specified.</summary><p>Available tables: <code>feedbacks</code>. Returns all feedbacks on the post.<br />
<strong>Write route</strong>. Requires POST request, valid write token, and parameters: <code>type</code> (feedback type, i.e. <code>tpu-</code>).<br />
Output format: identical to <code>/feedback</code>.</p>
</details></td></tr>
<tr><td><strong>Moderator Sites</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/mods </code></td><td><details><summary> List all ModeratorSites.</summary><p>Available tables: <code>moderator_sites</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 970,
            &quot;user_id&quot;: 5,
            &quot;site_id&quot;: 1
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/mods/user/:id </code></td><td><details><summary> List all ModeratorSites for the specified user.</summary><p>Available tables: <code>moderator_sites</code>.<br />
Output format: identical to <code>/mods</code>.</p>
</details></td></tr>
<tr><td><strong>Posts</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/posts </code></td><td><details><summary> List all posts.</summary><p>Available tables: <code>posts</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 78099,
            &quot;title&quot;: &quot;test&quot;,
            &quot;link&quot;: &quot;//stackoverflow.com/a/3498236&quot;,
            &quot;site_id&quot;: 1,
            &quot;user_link&quot;: &quot;//stackoverflow.com/u/3160466&quot;,
            &quot;username&quot;: &quot;ArtOfCode&quot;,
            &quot;user_reputation&quot;: 3478
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/between </code></td><td><details><summary> List posts within a specified date range.</summary><p>Requires params: <code>from</code> (range start date) and <code>to</code> (range end date). Both are in ISO 8601 format - <code>1970-01-01T00:00:00.000000Z</code>.<br />
Available tables: <code>posts</code>.<br />
Output format: identical to <code>/posts</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/site </code></td><td><details><summary> List posts on a specific site.</summary><p>Requires params: <code>site</code> (site domain name).<br />
Available tables: <code>posts</code>.<br />
Output format: identical to <code>/posts</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/urls </code></td><td><details><summary> List posts specified by their URLs.</summary><p>Requires params: <code>urls</code> (a <strong>comma</strong> separated list of URLs).<br />
URLs are of the format //stackoverflow.com/a/12345 (for answers) or //stackoverflow.com/questions/12345 (for questions).<br />
Available tables: <code>posts</code>.<br />
Output format: identical to <code>/posts</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/feedback </code></td><td><details><summary> List posts by feedback types.</summary><p>Requires params: <code>type</code> (feedback type).<br />
Available tables: <code>posts</code>.<br />
Output format: identical to <code>/posts</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/undeleted </code></td><td><details><summary> List posts that have not yet been deleted.</summary><p>Looks for the absence of a DeletionLog record with <code>is_deleted: true</code> on the post - may not be 100% accurate; use the SE API if that&#39;s what you need.<br />
Available tables: <code>posts</code>.<br />
Output format: identical to <code>/posts</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/uid/:api_param/:native_id </code></td><td><details><summary> Get a post by its API site parameter and SE-native ID.</summary><p>Finds posts on the site specified by <code>:api_param</code> with the post ID specified in <code>:native_id</code>, and returns them.<br />
Available tables: <code>posts</code>.<br />
Output format: identical to <code>/posts</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/:ids </code></td><td><details><summary> List posts by their IDs</summary><p><code>ids</code> is a <strong>comma</strong> separated list of post IDs to return.<br />
Available tables: <code>posts</code>.<br />
Output format: identical to <code>/posts</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/:id/reasons </code></td><td><details><summary> List the reasons a post was caught by.</summary><p>Available tables: <code>reasons</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 106,
            &quot;reason_name&quot;: &quot;Repeated url at end of long post&quot;,
            &quot;weight&quot;: 99
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/:id/domains </code></td><td><details><summary> List the domain names contained in a post.</summary><p>Available tables: <code>spam_domains</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 3993,
            &quot;domain&quot;: &quot;www.drhelpnutrition.org&quot;,
            &quot;whois&quot;: null
        }
    ],
    &quot;has_more&quot;: false
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/:id/flags </code></td><td><details><summary> Get details of what automatic and manual flags have been cast on a post.</summary><p>Available tables: N/A. This route provides a specific, unfilterable subset of information.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 78000,
            &quot;autoflagged&quot;: {
                &quot;flagged&quot;: true,
                &quot;users&quot;: [
                    {
                        &quot;id&quot;: 14,
                        &quot;username&quot;: &quot;ProgramFOX&quot;,
                        &quot;stackexchange_chat_id&quot;: 123456,
                        &quot;stackoverflow_chat_id&quot;: 123456,
                        &quot;meta_chat_id&quot;: 123456
                    },
                    {
                        &quot;id&quot;: 42,
                        &quot;username&quot;: &quot;QPaysTaxes&quot;,
                        &quot;stackexchange_chat_id&quot;: 123456,
                        &quot;stackoverflow_chat_id&quot;: 123456,
                        &quot;meta_chat_id&quot;: 123456
                    },
                    {
                        &quot;id&quot;: 226,
                        &quot;username&quot;: &quot;guiniveretoo&quot;,
                        &quot;stackexchange_chat_id&quot;: 123456,
                        &quot;stackoverflow_chat_id&quot;: 123456,
                        &quot;meta_chat_id&quot;: 123456
                    }
                ]
            },
            &quot;manual_flags&quot;: {
                &quot;users&quot;: [
                    {
                        &quot;id&quot;: 7,
                        &quot;username&quot;: &quot;ArtOfCode&quot;,
                        &quot;stackexchange_chat_id&quot;: 123456,
                        &quot;stackoverflow_chat_id&quot;: 123456,
                        &quot;meta_chat_id&quot;: 123456
                    }
                ]
            }
        }
    ],
    &quot;has_more&quot;: false
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/report </code></td><td><details><summary> [W] Report a post.</summary><p><strong>Write route</strong>. Requires a POST request, valid write token, and parameters: <code>url</code> (the post URL to report).<br />
Available tables: N/A. No database information is returned from this request.<br />
All requests to this route will be met with a 202 Accepted status; metasmoke does not know the status of reports as it just forwards them to Smokey.<br />
Output format:</p>

<pre><code>{
    &quot;status&quot;: &quot;Accepted&quot;
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/:id/flag </code></td><td><details><summary> [W] Cast a flag on a post.</summary><p><strong>Write route</strong>. Requires a POST request and valid write token.<br />
Available tables: N/A. No database information is returned from this request.<br />
<code>backoff</code> will only be set on successful requests. <code>message</code> will only be set on failed requests.<br />
Specify the <code>flag_type</code> param to choose your flag type: either <code>spam</code> (default) or <code>abusive</code> for an R/A flag.<br />
Output format:</p>

<pre><code>{
    &quot;status&quot;: &quot;success|failed&quot;,
    &quot;backoff&quot;: &quot;10&quot;,
    &quot;message&quot;: &quot;failure reason&quot;
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/posts/search{.:format} </code></td><td><details><summary> Get an RSS or Atom feed of posts matching certain criteria.</summary><p><code>format</code> may be either <code>rss</code> or <code>atom</code>, e.g. <code>/api/v2.0/posts/search.rss</code>.<br />
Filters are not available on this route.<br />
Output format for RSS and Atom feeds is consistent with RSS and Atom standards, respectively.</p>
</details></td></tr>
<tr><td><strong>Reasons</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/reasons </code></td><td><details><summary> List all reasons.</summary><p>Available tables: <code>reasons</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 134,
            &quot;reason_name&quot;: &quot;Pattern-matching email in body&quot;,
            &quot;weight&quot;: 0
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/reasons/:ids </code></td><td><details><summary> List reasons specified by their IDs.</summary><p>Available tables: <code>reasons</code>.<br />
Output format: identical to <code>/reasons</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/reasons/:id/posts </code></td><td><details><summary> List posts caught by a specific reason.</summary><p>Available tables: <code>posts</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 78099,
            &quot;title&quot;: &quot;test&quot;,
            &quot;link&quot;: &quot;//stackoverflow.com/a/3498236&quot;,
            &quot;site_id&quot;: 1,
            &quot;user_link&quot;: &quot;//stackoverflow.com/u/3160466&quot;,
            &quot;username&quot;: &quot;ArtOfCode&quot;,
            &quot;user_reputation&quot;: 3478
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><strong>Sites</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/sites </code></td><td><details><summary> List all sites</summary><p>Available tables: <code>sites</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 1,
            &quot;site_name&quot;: &quot;Stack Overflow&quot;,
            &quot;site_url&quot;: &quot;https://stackoverflow.com&quot;
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><strong>SmokeDetectors</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/smokeys </code></td><td><details><summary> List all SmokeDetector instances.</summary><p>Available tables: <code>smoke_detectors</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 17,
            &quot;last_ping&quot;: &quot;2017-07-24T00:47:50.000Z&quot;,
            &quot;location&quot;: &quot;The Call of Midnight&quot;,
            &quot;user_id&quot;: 47,
            &quot;status_color&quot;: &quot;critical&quot;
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><strong>Domains</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/domains </code></td><td><details><summary> List all domains.</summary><p>Available tables: <code>spam_domains</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 12935,
            &quot;domain&quot;: &quot;infinitemlmsoftware.com&quot;,
            &quot;whois&quot;: null
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/domains/name/:name </code></td><td><details><summary> Find a domain record by its domain name</summary><p>Available tables: <code>spam_domains</code>.<br />
Output format: identical to <code>/domains</code>.</p>
</details></td></tr>
<tr><td><code>/api/v2.0/domains/:id/posts </code></td><td><details><summary> List all posts containing a specific domain.</summary><p>Available tables: <code>posts</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 77988,
            &quot;title&quot;: &quot;Google Webmaster Tools show the error in Manual Action for my web - https://infinitemlmsoftware.com/&quot;,
            &quot;link&quot;: &quot;//drupal.stackexchange.com/questions/242498&quot;,
            &quot;site_id&quot;: 86,
            &quot;user_link&quot;: &quot;https://drupal.stackexchange.com/users/77863/isha&quot;,
            &quot;username&quot;: &quot;isha&quot;,
            &quot;user_reputation&quot;: 1
        }
    ],
    &quot;has_more&quot;: false
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/domains/:id/tags/add </code></td><td><details><summary> [W] Add a tag to a specified domain.</summary><p><strong>Write route</strong>. Requires a POST request, valid write token, and params: <code>tag</code> (the name of the tag to add).<br />
Available tables: <code>domain_tags</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 16,
            &quot;name&quot;: &quot;blargle&quot;,
            &quot;description&quot;: null
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><strong>Users</strong></td><td></td></tr>
<tr><td><code>/api/v2.0/users </code></td><td><details><summary> List all users.</summary><p>Available tables: <code>users</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 311,
            &quot;username&quot;: &quot;Art&quot;
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/users/with_role/:role </code></td><td><details><summary> List all users with the specified role</summary><p>Available tables: <code>users</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 311,
            &quot;username&quot;: &quot;Art&quot;
        }
    ],
    &quot;has_more&quot;: true
}
</code></pre>
</details></td></tr>
<tr><td><code>/api/v2.0/users/current-roles </code></td><td><details><summary> Get roles for the current user</summary><p>Available tables: <code>roles</code>.<br />
Output format:</p>

<pre><code>{
    &quot;items&quot;: [
        {
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;admin&quot;
        }
    ],
    &quot;has_more&quot;: false
}
</code></pre>
</details></td></tr>
</tbody>
</table>


<div class="sidebar">



<p><strong><a href="//github.com/Charcoal-SE/metasmoke/wiki/API-Documentation-(V2)/_edit"><i class="fa fa-pencil"></i> Edit on GitHub</a></strong></p>

<div class="sidebar-content sidebar-content-ms">

  <p><strong><a href="Home">Home</a></strong></p>

  <p><strong><a href="API-Documentation-(V2)">API Documentation</a> (<a href="API-Documentation-(V1)">V1</a>)</strong></p>

  <p><strong><a href="WebSocket-API">WebSocket API Documentation</a></strong></p>

  <p><strong><a href="https://github.com/Charcoal-SE/metasmoke/wiki/Set-up-local-instance-of-metasmoke-(Linux-macOS-Windows-WSL---v16170)">Setting up an instance</a></strong></p>

  <p><strong><a href="https://github.com/Charcoal-SE/metasmoke/wiki/FAQ:-search">FAQ: Search</a></strong></p>

</div>


</div>


<div class="footer footer-insert text-center">
<p>metasmoke is made with &lt;3 by the <a href="http://charcoal-se.org/people.html">Charcoal Team</a> and the other awesome <a href="https://github.com/Charcoal-SE/metasmoke/graphs/contributors">contributors</a> from <a href="http://chat.stackexchange.com/rooms/11540/charcoal-hq">Charcoal HQ</a>.</p>
</div>

    </div>
    <div class="footer text-center">
      <p>Charcoal is not affiliated with or sponsored by Stack Exchange, Inc.<br />
        <a href="/security">Security</a> • <a href="/pings/">Contact</a>
      </p>
      <p>
        <a href="https://github.com/Charcoal-SE/charcoal-se.github.io">Website Source</a>
        • By
          
            <a href="https://github.com/j-f1" class="avatar-link">
              <img class="avatar avatar-small" alt="j-f1" width="16" height="16" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/j-f1?v=3&s=16" srcset="https://avatars2.githubusercontent.com/j-f1?v=3&s=16 1x, https://avatars2.githubusercontent.com/j-f1?v=3&s=32 2x, https://avatars2.githubusercontent.com/j-f1?v=3&s=48 3x, https://avatars2.githubusercontent.com/j-f1?v=3&s=64 4x" />j-f1</a>,
          
            <a href="https://github.com/ArtOfCode-" class="avatar-link">
              <img class="avatar avatar-small" alt="ArtOfCode-" width="16" height="16" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/ArtOfCode-?v=3&s=16" srcset="https://avatars2.githubusercontent.com/ArtOfCode-?v=3&s=16 1x, https://avatars2.githubusercontent.com/ArtOfCode-?v=3&s=32 2x, https://avatars2.githubusercontent.com/ArtOfCode-?v=3&s=48 3x, https://avatars2.githubusercontent.com/ArtOfCode-?v=3&s=64 4x" />ArtOfCode-</a>,
          
            <a href="https://github.com/iBug" class="avatar-link">
              <img class="avatar avatar-small" alt="iBug" width="16" height="16" data-proofer-ignore="true" src="https://avatars0.githubusercontent.com/iBug?v=3&s=16" srcset="https://avatars0.githubusercontent.com/iBug?v=3&s=16 1x, https://avatars0.githubusercontent.com/iBug?v=3&s=32 2x, https://avatars0.githubusercontent.com/iBug?v=3&s=48 3x, https://avatars0.githubusercontent.com/iBug?v=3&s=64 4x" />iBug</a>,
          
            <a href="https://github.com/angussidney" class="avatar-link">
              <img class="avatar avatar-small" alt="angussidney" width="16" height="16" data-proofer-ignore="true" src="https://avatars1.githubusercontent.com/angussidney?v=3&s=16" srcset="https://avatars1.githubusercontent.com/angussidney?v=3&s=16 1x, https://avatars1.githubusercontent.com/angussidney?v=3&s=32 2x, https://avatars1.githubusercontent.com/angussidney?v=3&s=48 3x, https://avatars1.githubusercontent.com/angussidney?v=3&s=64 4x" />angussidney</a>,
          
          and
          <a href="https://github.com/Charcoal-SE/charcoal-se.github.io/graphs/contributors">
            20 more</a>
        
          • <a href="/code">More gory details</a>
        
      </p>
      
    </div>
  </div>
  <script>
    window.searchConfig = {
      appId: 'TMPUB31BTZ',
      key: 'c63c2f79258f929439376cfb88862440',
      index: 'main-search',
      baseUrl: '',
    }
    window.redirects = { "/channel": "https://stackoverflow.com/c/charcoal", "/m": "https://metasmoke.erwaysoftware.com", "/store": "https://www.zazzle.co.uk/charcoal_se/products", "/smokey/Home": "https://charcoal-se.org//smokey/", "/smokey/Home": "https://charcoal-se.org//smokey/", "/announcements": "https://charcoal-se.org//announcements/", "/ms/Home": "https://charcoal-se.org//ms/", "/ms/Home": "https://charcoal-se.org//ms/", "/userscripts/": "https://charcoal-se.org//scripts.html", "/userscripts": "https://charcoal-se.org//scripts.html",  }
  </script>
  <!-- Hotjar Tracking Code for charcoal-se.org -->
  <script>
    (function(h,o,t,j,a,r){
      h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
      h._hjSettings={hjid:771814,hjsv:6};
      a=o.getElementsByTagName('head')[0];
      r=o.createElement('script');r.async=1;
      r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
      a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
  </script>
</body>
</html>
